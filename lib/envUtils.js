require('dotenv').config(); const NODE_ENV = process.env.NODE_ENV || 'development'; const DEFAULT_ERROR_MESSAGE = 'An unexpected error occurred'; const getMissingEnvVars = varArr => varArr.filter(name => !process.env[name]); const throwIfMissingEnvVars = varArr => { const missingEnvVars = getMissingEnvVars(varArr); if (missingEnvVars.length) { const errorMessage = `Missing required environment variables: ${missingEnvVars.join(', ')}`; console.error(errorMessage); const err = new Error(errorMessage); console.error(err); throw err; } return missingEnvVars; }; const warnIfMissingEnvVars = (varArr, customMessage = '') => { const missingEnvVars = getMissingEnvVars(varArr); missingEnvVars.length && console.warn(customMessage || `Warning: Optional environment variables missing: ${missingEnvVars.join(', ')}. Some features may not work as expected.`); return missingEnvVars.length === 0; }; const validateRequiredEnvVars = vars => throwIfMissingEnvVars(vars); const warnMissingEnvVars = vars => warnIfMissingEnvVars(vars); const hasEnvFile = () => require('fs').existsSync('.env'); const getEnvHealth = (requiredVars = [], optionalVars = []) => { const missingRequired = getMissingEnvVars(requiredVars), missingOptional = getMissingEnvVars(optionalVars); return { environment: NODE_ENV, hasEnvFile: hasEnvFile(), isHealthy: missingRequired.length === 0, required: { total: requiredVars.length, configured: requiredVars.length - missingRequired.length, missing: missingRequired }, optional: { total: optionalVars.length, configured: optionalVars.length - missingOptional.length, missing: missingOptional }, summary: { totalVars: requiredVars.length + optionalVars.length, configuredVars: (requiredVars.length - missingRequired.length) + (optionalVars.length - missingOptional.length) } }; }; const validateEnvironment = (options = {}) => { const { required = [], optional = [], throwOnError = true } = options; const health = getEnvHealth(required, optional); throwOnError && !health.isHealthy && throwIfMissingEnvVars(required); return health; }; module.exports = { NODE_ENV, DEFAULT_ERROR_MESSAGE, getMissingEnvVars, throwIfMissingEnvVars, warnIfMissingEnvVars, validateRequiredEnvVars, warnMissingEnvVars, hasEnvFile, getEnvHealth, validateEnvironment };