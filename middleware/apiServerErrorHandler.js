import qerrors from './lib/qerrors.js';const configureErrorHandling=app=>app.use((err,req,res,next)=>{if(res.headersSent){console.error('Error occurred after headers sent:',err.message);return;}const context={url:req.url,method:req.method,ip:req.ip||req.connection.remoteAddress,userAgent:req.get('User-Agent'),memoryBefore:req.memoryContext,memoryAfter:res.memoryAfter,timestamp:Date.now()};qerrors(err,'api-server.middleware.errorHandler',context,req,res,next).catch(error=>{console.error('qerrors error handling failed:',error.message);!res.headersSent&&res.status(500).json({error:'Internal Server Error',message:'An unexpected error occurred',timestamp:new Date().toISOString(),fallback:true});});});export{configureErrorHandling};