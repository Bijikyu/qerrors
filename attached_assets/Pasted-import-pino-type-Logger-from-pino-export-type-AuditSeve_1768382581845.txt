import pino,{type Logger}from'pino';export type AuditSeverity='LOW'|'MEDIUM'|'HIGH'|'CRITICAL';export type AuditCategory='AUTHENTICATION'|'AUTHORIZATION'|'DATA_ACCESS'|'DATA_MODIFICATION'|'SECURITY_EVENT'|'PAYMENT_OPERATION'|'PERFORMANCE';export type AuditOutcome='SUCCESS'|'FAILURE'|'ATTEMPT';export interface AuditEvent{timestamp:string;severity:AuditSeverity;category:AuditCategory;action:string;userId?:string;ipAddress?:string;userAgent?:string;resource?:string;outcome:AuditOutcome;details:Record<string,unknown>;auditId:string;}class PinoAuditLogger{private l:Logger;constructor(){this.l=(pino as any)({name:'audit-logger',level:'info',redact:['*.key','*.token','*.password','*.secret','*.clientSecret','*.authorization','*.bearer','*.creditCard','*.cardNumber','*.ssn','*.bankAccount'],timestamp:(pino as any).stdTimeFunctions.isoTime});}private g=():string=>{const{randomBytes}=require('crypto');const bytes=randomBytes(4);return`audit_${Date.now().toString(36)}_${bytes.toString('hex').substring(0,8)}`;};log=(e:Omit<AuditEvent,'timestamp'|'auditId'>):void=>this.l.info({type:'AUDIT_EVENT',auditEvent:{timestamp:new Date().toISOString(),auditId:this.g(),...e}});logAuth=(a:string,o:AuditOutcome,u?:string,d:Record<string,unknown>={}):void=>this.log({severity:o==='FAILURE'?'HIGH':'MEDIUM',category:'AUTHENTICATION',action:a,userId:u,outcome:o,details:d});logDataAccess=(r:string,a:string,u?:string,d:Record<string,unknown>={}):void=>this.log({severity:'LOW',category:'DATA_ACCESS',action:a,userId:u,resource:r,outcome:'SUCCESS',details:d});logDataModification=(r:string,a:string,o:AuditOutcome,u?:string,d:Record<string,unknown>={}):void=>this.log({severity:o==='SUCCESS'?'MEDIUM':'HIGH',category:'DATA_MODIFICATION',action:a,userId:u,resource:r,outcome:o,details:d});logSecurityEvent=(a:string,s:AuditSeverity,d:Record<string,unknown>={},u?:string):void=>this.log({severity:s,category:'SECURITY_EVENT',action:a,userId:u,outcome:'ATTEMPT',details:d});logPaymentOperation=(a:string,o:AuditOu...