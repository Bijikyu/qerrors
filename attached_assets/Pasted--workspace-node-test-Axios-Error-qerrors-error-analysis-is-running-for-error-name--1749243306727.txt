~/workspace$ node --test
Axios Error
qerrors error analysis is running for
            error name: "NOTOKEN",
            error message: "no token", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors error analysis is running for
            error name: "TESTERR",
            error message: "test error", 
            with context: "test context"
qerrors is returning advice for 
                the error name: "TESTERR",
                with the error message: "test error", 
                with context: "test context"
TESTERR {"advice":"test advice"}
qerrors error analysis is running for
            error name: "PARSEERR",
            error message: "test error", 
            with context: "test context"
Problem parsing advice JSON for PARSEERR
Problem in analyzeError function of qerrors for PARSEERR: test error
✔ analyzeError handles AxiosError gracefully (5.472419ms)
✔ analyzeError returns null without token (1.217209ms)
✔ analyzeError processes JSON response from API (2.248499ms)
✔ analyzeError handles JSON parse errors (1.523289ms)
✔ index exports qerrors and logger (2.098409ms)
✔ logger exposes standard logging methods (1.93945ms)
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749236024394_prpkpz4xs6d"
qerrors error analysis is running for
            error name: "ERROR: Error_1749236024394_prpkpz4xs6d",
            error message: "boom", 
            with context: "ctx"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749236024399_uq44bkskc5b"
qerrors error analysis is running for
            error name: "ERROR: Error_1749236024399_uq44bkskc5b",
            error message: "boom", 
            with context: "ctx"
qerrors ran
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749236024400_wc1tfkkq0tr"
qerrors error analysis is running for
            error name: "ERROR: Error_1749236024400_wc1tfkkq0tr",
            error message: "boom", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "boom", 
            with context: "unknown context", 
            assigning it the unique error name: "ERROR: Error_1749236024401_lkeb0g3mbh"
qerrors error analysis is running for
            error name: "ERROR: Error_1749236024401_lkeb0g3mbh",
            error message: "boom", 
            with context: "unknown context"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749236024401_rr8pd5egl9"
qerrors error analysis is running for
            error name: "ERROR: Error_1749236024401_rr8pd5egl9",
            error message: "boom", 
            with context: "ctx"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
✔ qerrors logs and responds with json then calls next (5.462248ms)
✔ qerrors sends html when accept header requests it (0.57583ms)
✔ qerrors does nothing when headers already sent (0.64736ms)
✔ qerrors handles absence of req res and next (0.71183ms)
✔ qerrors calls next without res (0.72465ms)
✔ qerrors exits if no error provided (0.28059ms)
ℹ tests 12
ℹ suites 0
ℹ pass 12
ℹ fail 0
ℹ cancelled 0
ℹ skipped 0
ℹ todo 0
ℹ duration_ms 437.181868
~/workspace$ git rm -r --cached node_modules && git add -f node_modules && git commit -m "Add node_modules" && git push origin HEAD
fatal: pathspec 'node_modules' did not match any files
~/workspace$ node --test
Axios Error
qerrors error analysis is running for
            error name: "NOTOKEN",
            error message: "no token", 
            with context: "ctx"
qerrors error analysis is running for
            error name: "TESTERR",
            error message: "test error", 
            with context: "test context"
qerrors is returning advice for 
                the error name: "TESTERR",
                with the error message: "test error", 
                with context: "test context"
TESTERR {"advice":"test advice"}
qerrors error analysis is running for
            error name: "PARSEERR",
            error message: "test error", 
            with context: "test context"
Problem parsing advice JSON for PARSEERR
Problem in analyzeError function of qerrors for PARSEERR: test error
Missing OPENAI_TOKEN in environment variables.
✔ analyzeError handles AxiosError gracefully (3.428629ms)
✔ analyzeError returns null without token (0.69486ms)
✔ analyzeError processes JSON response from API (1.46018ms)
✔ analyzeError handles JSON parse errors (0.48429ms)
✔ index exports qerrors and logger (1.86292ms)
qerrors is running for error message: "boom", 
            with context: "spyCtx", 
            assigning it the unique error name: "ERROR: Error_1749243261502_f2uc3epn7xa"
2025-06-06 20:54:21 error: boom
Error: boom
    at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:30:15)
    at Test.runInAsyncScope (node:async_hooks:206:9)
    at Test.run (node:internal/test_runner/test:796:25)
    at Test.processPendingSubtests (node:internal/test_runner/test:527:18)
    at node:internal/test_runner/harness:255:12
    at node:internal/process/task_queues:140:7
    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
    at AsyncResource.runMicrotask (node:internal/process/task_queues:137:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261502_f2uc3epn7xa",
            error message: "boom", 
            with context: "spyCtx"
qerrors is returning advice for 
                the error name: "ERROR: Error_1749243261502_f2uc3epn7xa",
                with the error message: "boom", 
                with context: "spyCtx"
ERROR: Error_1749243261502_f2uc3epn7xa {"ok":true}
qerrors ran
✖ qerrors integration logs error and analyzes context (11.939428ms)
  AssertionError [ERR_ASSERTION]: Expected values to be strictly equal:
  + actual - expected
  
  + undefined
  - 'spyCtx'
      at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:40:10)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async Test.run (node:internal/test_runner/test:797:9)
      at async Test.processPendingSubtests (node:internal/test_runner/test:527:7) {
    generatedMessage: true,
    code: 'ERR_ASSERTION',
    actual: undefined,
    expected: 'spyCtx',
    operator: 'strictEqual'
  }

✔ logger exposes standard logging methods (1.86744ms)
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261503_p0cry3mnr9"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261503_p0cry3mnr9",
            error message: "boom", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261508_fkaun7983z6"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261508_fkaun7983z6",
            error message: "boom", 
            with context: "ctx"
qerrors ran
qerrors is running for error message: "not found", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261510_0rcn5ewnpllk"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261510_0rcn5ewnpllk",
            error message: "not found", 
            with context: "ctx"
qerrors ran
qerrors is running for error message: "not found", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261511_kazqic5lks"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261511_kazqic5lks",
            error message: "not found", 
            with context: "ctx"
qerrors ran
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261512_j7e896pu77m"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261512_j7e896pu77m",
            error message: "boom", 
            with context: "ctx"
qerrors ran
qerrors is running for error message: "boom", 
            with context: "unknown context", 
            assigning it the unique error name: "ERROR: Error_1749243261513_e0dmk6r2oum"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261513_e0dmk6r2oum",
            error message: "boom", 
            with context: "unknown context"
qerrors ran
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243261516_rsuneqdewtk"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243261516_rsuneqdewtk",
            error message: "boom", 
            with context: "ctx"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
Missing OPENAI_TOKEN in environment variables.
✔ qerrors logs and responds with json then calls next (5.872039ms)
✔ qerrors sends html when accept header requests it (0.95148ms)
✔ qerrors honors error.statusCode in json (1.069239ms)
✔ qerrors honors error.statusCode in html (1.383729ms)
✔ qerrors does nothing when headers already sent (1.07078ms)
✔ qerrors handles absence of req res and next (0.80323ms)
✔ qerrors calls next without res (0.60093ms)
✔ qerrors exits if no error provided (0.36525ms)
ℹ tests 15
ℹ suites 0
ℹ pass 14
ℹ fail 1
ℹ cancelled 0
ℹ skipped 0
ℹ todo 0
ℹ duration_ms 386.3157

✖ failing tests:

test at test/integration.qerrors.test.js:20:1
✖ qerrors integration logs error and analyzes context (11.939428ms)
  AssertionError [ERR_ASSERTION]: Expected values to be strictly equal:
  + actual - expected
  
  + undefined
  - 'spyCtx'
      at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:40:10)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async Test.run (node:internal/test_runner/test:797:9)
      at async Test.processPendingSubtests (node:internal/test_runner/test:527:7) {
    generatedMessage: true,
    code: 'ERR_ASSERTION',
    actual: undefined,
    expected: 'spyCtx',
    operator: 'strictEqual'
  }
~/workspace$ node -r ./setup.js --test
Axios Error
qerrors error analysis is running for
            error name: "NOTOKEN",
            error message: "no token", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors error analysis is running for
            error name: "TESTERR",
            error message: "test error", 
            with context: "test context"
qerrors is returning advice for 
                the error name: "TESTERR",
                with the error message: "test error", 
                with context: "test context"
TESTERR {"advice":"test advice"}
qerrors error analysis is running for
            error name: "PARSEERR",
            error message: "test error", 
            with context: "test context"
Problem parsing advice JSON for PARSEERR
Problem in analyzeError function of qerrors for PARSEERR: test error
✔ analyzeError handles AxiosError gracefully (7.452699ms)
✔ analyzeError returns null without token (0.695831ms)
✔ analyzeError processes JSON response from API (2.13953ms)
✔ analyzeError handles JSON parse errors (1.84386ms)
✔ index exports qerrors and logger (1.58246ms)
qerrors is running for error message: "boom", 
            with context: "spyCtx", 
            assigning it the unique error name: "ERROR: Error_1749243276210_jzwp5iuz9u"
2025-06-06 20:54:36 error: boom
Error: boom
    at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:30:15)
    at Test.runInAsyncScope (node:async_hooks:206:9)
    at Test.run (node:internal/test_runner/test:796:25)
    at Test.processPendingSubtests (node:internal/test_runner/test:527:18)
    at node:internal/test_runner/harness:255:12
    at node:internal/process/task_queues:140:7
    at AsyncResource.runInAsyncScope (node:async_hooks:206:9)
    at AsyncResource.runMicrotask (node:internal/process/task_queues:137:8)
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276210_jzwp5iuz9u",
            error message: "boom", 
            with context: "spyCtx"
qerrors is returning advice for 
                the error name: "ERROR: Error_1749243276210_jzwp5iuz9u",
                with the error message: "boom", 
                with context: "spyCtx"
ERROR: Error_1749243276210_jzwp5iuz9u {"ok":true}
qerrors ran
✖ qerrors integration logs error and analyzes context (10.695918ms)
  AssertionError [ERR_ASSERTION]: Expected values to be strictly equal:
  + actual - expected
  
  + undefined
  - 'spyCtx'
      at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:40:10)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async Test.run (node:internal/test_runner/test:797:9)
      at async Test.processPendingSubtests (node:internal/test_runner/test:527:7) {
    generatedMessage: true,
    code: 'ERR_ASSERTION',
    actual: undefined,
    expected: 'spyCtx',
    operator: 'strictEqual'
  }

✔ logger exposes standard logging methods (2.03545ms)
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276261_56j8rzgw0ip"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276261_56j8rzgw0ip",
            error message: "boom", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276264_f8u1t1hks5r"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276264_f8u1t1hks5r",
            error message: "boom", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "not found", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276265_6y4vq48fv3c"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276265_6y4vq48fv3c",
            error message: "not found", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "not found", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276265_xy99xypzmd"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276265_xy99xypzmd",
            error message: "not found", 
            with context: "ctx"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276266_uuy4xc5r9fj"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276266_uuy4xc5r9fj",
            error message: "boom", 
            with context: "ctx"
Missing OPENAI_TOKEN in environment variables.
qerrors ran
qerrors is running for error message: "boom", 
            with context: "unknown context", 
            assigning it the unique error name: "ERROR: Error_1749243276267_e9z4r6xl3a"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276267_e9z4r6xl3a",
            error message: "boom", 
            with context: "unknown context"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
qerrors is running for error message: "boom", 
            with context: "ctx", 
            assigning it the unique error name: "ERROR: Error_1749243276267_cp0jlzf8a2p"
qerrors error analysis is running for
            error name: "ERROR: Error_1749243276267_cp0jlzf8a2p",
            error message: "boom", 
            with context: "ctx"
qerrors ran
Missing OPENAI_TOKEN in environment variables.
✔ qerrors logs and responds with json then calls next (3.568859ms)
✔ qerrors sends html when accept header requests it (0.56678ms)
✔ qerrors honors error.statusCode in json (0.60739ms)
✔ qerrors honors error.statusCode in html (0.60548ms)
✔ qerrors does nothing when headers already sent (0.54747ms)
✔ qerrors handles absence of req res and next (0.51212ms)
✔ qerrors calls next without res (0.39979ms)
✔ qerrors exits if no error provided (1.54478ms)
ℹ tests 15
ℹ suites 0
ℹ pass 14
ℹ fail 1
ℹ cancelled 0
ℹ skipped 0
ℹ todo 0
ℹ duration_ms 397.272117

✖ failing tests:

test at test/integration.qerrors.test.js:20:1
✖ qerrors integration logs error and analyzes context (10.695918ms)
  AssertionError [ERR_ASSERTION]: Expected values to be strictly equal:
  + actual - expected
  
  + undefined
  - 'spyCtx'
      at TestContext.<anonymous> (/home/runner/workspace/test/integration.qerrors.test.js:40:10)
      at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
      at async Test.run (node:internal/test_runner/test:797:9)
      at async Test.processPendingSubtests (node:internal/test_runner/test:527:7) {
    generatedMessage: true,
    code: 'ERR_ASSERTION',
    actual: undefined,
    expected: 'spyCtx',
    operator: 'strictEqual'
  }